From: Mike Engel <Mike.Engel@digi.com>
Date: Wed, 15 Mar 2017 18:01:06 +0100
Subject: [PATCH] meta-digi-dey: Add fix to return correct error code.

Signed-off-by: Mike Engel <Mike.Engel@digi.com>
---
 .../meta-digi-dey/recipes-connectivity/modemmanager/mm-broadband-modem-qmi.c       | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/mm-broadband-modem-qmi.c b/src/mm-broadband-modem-qmi.c
index bc13925..f60d0f4 100644
--- a/src/mm-broadband-modem-qmi.c
+++ b/src/mm-broadband-modem-qmi.c
@@ -1740,7 +1740,10 @@ dms_uim_get_pin_status_ready (QmiClientDms *client,
         /* We get InvalidQmiCommand on newer devices which don't like the legacy way */
         if (g_error_matches (error,
                              QMI_PROTOCOL_ERROR,
-                             QMI_PROTOCOL_ERROR_INVALID_QMI_COMMAND)) {
+                             QMI_PROTOCOL_ERROR_INVALID_QMI_COMMAND) ||
+            g_error_matches (error,
+                             QMI_PROTOCOL_ERROR,
+                             QMI_PROTOCOL_ERROR_NOT_SUPPORTED)) {
             g_error_free (error);
             qmi_message_dms_uim_get_pin_status_output_unref (output);
             /* Flag that the command is unsupported, and try with the new way */